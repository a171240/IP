<view class="page page-mine">
  <view class="container">
    <view class="hero fade-up">
      <view class="row space-between">
        <view>
          <text class="title">我的</text>
          <text class="subtitle">账号与订阅</text>
        </view>
        <view class="chip" wx:if="{{isLoggedIn}}">已登录</view>
        <view class="chip" wx:else>未登录</view>
      </view>

      <view class="profile-card" wx:if="{{isLoggedIn}}">
        <image class="avatar" src="{{avatarUrl}}" mode="aspectFill" wx:if="{{avatarUrl}}" />
        <view class="profile-info">
          <text class="card-title">{{displayName}}</text>
          <text class="muted small">微信已绑定</text>
        </view>
        <button class="btn-outline" bindtap="handleLogout">退出登录</button>
      </view>

      <view class="profile-card" wx:else>
        <text class="muted small">登录后可同步积分与订阅状态</text>
        <button class="btn-primary" bindtap="handleLoginTap">微信一键登录</button>
      </view>
    </view>

    <view class="section fade-up delay-1">
      <text class="section-title">订阅与积分</text>
      <view class="card">
        <text class="card-title">当前套餐</text>

        <view wx:if="{{isLoggedIn}}">
          <text class="muted small">{{planLabel || "加载中..."}}</text>
          <text class="muted small" style="margin-top: 6rpx;">
            积分：{{creditsUnlimited ? "无限" : creditsBalance}}
          </text>
          <button class="btn-primary" bindtap="handleUpgrade">升级/购买</button>
        </view>

        <view wx:else>
          <text class="muted small">登录后展示实时权益与积分</text>
          <button class="btn-primary" bindtap="handleLoginTap">去登录</button>
        </view>
      </view>
    </view>

    <view class="section fade-up delay-2">
      <text class="section-title">订单</text>
      <view class="card">
        <text class="card-title">订单与开通记录</text>
        <text class="muted small">支付后这里可查看状态</text>
        <button class="btn-outline" bindtap="handleOrders" wx:if="{{isLoggedIn}}">查看订单</button>
        <button class="btn-outline" bindtap="handleLoginTap" wx:else>去登录</button>
      </view>
    </view>

    <view class="section fade-up delay-2">
      <text class="section-title">工具</text>
      <view class="card">
        <text class="card-title">门店档案</text>
        <text class="muted small">一次配置，发文时可复用</text>
        <button class="btn-outline" bindtap="handleStoreProfiles">管理门店档案</button>
      </view>

      <view class="card" style="margin-top: 16rpx;">
        <text class="card-title">销售话术练习</text>
        <text class="muted small">语音对话 + 逐句点评 + 练后报告</text>
        <button class="btn-primary" bindtap="handleVoiceCoach">开始练习</button>
      </view>

      <view class="card" style="margin-top: 16rpx;">
        <text class="card-title">进阶工具</text>
        <text class="muted small">P1-P10 工作流等能力（默认隐藏）</text>
        <button class="btn-outline" bindtap="handleAdvanced">打开进阶</button>
      </view>
    </view>
  </view>
</view>
