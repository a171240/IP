# P4 IP概念生成提示词集成

**更新时间**: 2025-12-14

## 完成的工作

### 1. 创建独立提示词文件

**文件位置**: [lib/prompts/persona/p4-concept.ts](lib/prompts/persona/p4-concept.ts)

创建了 P4（IP概念生成）的独立提示词文件，采用模块化管理：

```typescript
// P4: IP概念生成器智能体提示词
export const p4ConceptPrompt = `# IP概念生成器智能体提示词
...
`
```

**提示词来源**: [提示词/IP概念生成器智能体（2.0）.md](提示词/IP概念生成器智能体（2.0）.md)

### 2. 集成到主配置文件

**文件位置**: [lib/prompts/step-prompts.ts](lib/prompts/step-prompts.ts)

修改内容：
1. **导入独立模块** (第4行):
```typescript
import { p4ConceptPrompt } from './persona/p4-concept'
```

2. **添加到配置对象** (第702行):
```typescript
'P4': p4ConceptPrompt,
```

### 3. 提示词内容概述

P4 提示词包含以下核心模块：

#### 角色定义
- 专业IP形象策划专家
- 擅长心理分析和行为模式提炼
- 专注短视频平台传播

#### 输出框架（六大部分）

1. **内核分析**
   - 童年经历与心理形成
   - 关键人物影响分析
   - 人生经历的心理投射
   - 内核总结

2. **外在表现分析**
   - 行为特征
   - 情绪表现

3. **视觉锤设计**
   - 核心视觉概念
   - 标志性视觉元素

4. **短视频平台优化**
   - 平台用户喜好分析
   - IP概念优化方向

5. **口播内容设计**
   - 前期分析总结
   - 口头语体系（开场/过程/收尾）
   - 口播场景推荐（最优/次优/点缀/避免）
   - 道具设计（主道具/辅助道具/细节道具）
   - 内容模板（30秒/60秒版本）

6. **最终IP定位**
   - IP概念总结（内核/外显/概念/目的）
   - 一句话总结

#### 分析原则
1. 心理学视角
2. 细节敏感
3. 真实性
4. 传播力
5. 商业闭环

#### 禁止事项
1. 不进行肤浅的特征罗列
2. 不忽视内在动机
3. 不生硬植入元素
4. 不过度娱乐化
5. 不忽视目标受众需求

### 4. 示例结构

提示词包含完整的输出示例（以"毛毛"为例），展示了：
- 如何从童年创伤分析心理内核
- 如何设计视觉锤和口头语
- 如何优化短视频平台呈现
- 如何制作内容模板

## 文件结构

```
lib/prompts/
├── step-prompts.ts          # 主配置文件（已更新）
├── persona/                 # 人设构建阶段提示词
│   └── p4-concept.ts       # P4 提示词 ✅ 新建
└── research/               # 研究定位阶段（预留）
```

## 技术实现

### 模块化优势
1. **易于维护**: P4 提示词独立文件，修改不影响其他步骤
2. **清晰分类**: 按阶段（研究/人设/生产）组织
3. **版本控制**: Git 可以追踪单个提示词的修改历史
4. **团队协作**: 多人可以同时编辑不同步骤的提示词

### 导入机制
```typescript
// 1. 导入
import { p4ConceptPrompt } from './persona/p4-concept'

// 2. 使用
export const stepPrompts: Record<string, string> = {
  'P1': `...`,  // 内联提示词
  'P2': `...`,  // 内联提示词
  'P3': `...`,  // 内联提示词
  'IP传记': `...`,  // 内联提示词
  'P4': p4ConceptPrompt,  // 引用独立模块 ✅
}
```

## 工作流步骤配置

P4 在工作流中的配置 ([app/dashboard/page.tsx](app/dashboard/page.tsx:24)):

```typescript
{
  id: "P4",
  phase: "人设构建",
  title: "IP概念",
  summary: "输出差异化定位、表达锚点与人设框架。"
}
```

P4 详细配置 ([app/dashboard/workflow/[stepId]/page.tsx](app/dashboard/workflow/[stepId]/page.tsx:141-158)):

```typescript
"P4": {
  id: "P4",
  title: "IP概念生成",
  description: "生成差异化IP定位、视觉锤、语言钉",
  icon: User,
  phase: 2,
  phaseName: "人设构建",
  phaseColor: "blue",
  output: "《IP概念》",
  estimatedTime: "15-25分钟",
  features: ["内核分析", "外在表现", "视觉锤设计", "口头语体系"],
  initialPrompt: "太棒了！现在我们来打造你的IP概念。\n\n基于前面的行业分析和你的个人故事，我会帮你提炼：\n- **IP内核**：你是谁，你代表什么\n- **视觉锤**：让人一眼记住的视觉符号\n- **语言钉**：你的专属口头禅和金句\n\n首先，你希望给观众留下什么样的第一印象？",
  guideQuestions: [
    "你希望别人怎么形容你？",
    "有什么个人特征是你独有的？",
    "你最想传达的核心理念是什么？"
  ]
}
```

**注意**: `initialPrompt` 是用户首次进入步骤看到的简短欢迎语，真正的详细提示词来自 `step-prompts.ts` 中的 `p4ConceptPrompt`。

## 使用方式

### 用户流程
1. 完成 P1-P3 和 IP传记步骤
2. 进入 P4（IP概念生成）
3. AI 使用完整的专业提示词进行深度分析
4. 生成《IP概念完整方案》
5. 使用画布功能编辑和保存

### AI 行为
- 基于 P4 提示词进行系统化分析
- 从《IP传记》中提取关键信息
- 运用心理学原理分析人物内核
- 设计符合平台传播的IP概念
- 输出结构化的完整方案

## 提示词特点

### 深度分析
- 不只看表面特征，深挖心理动机
- 从童年经历到行为模式的完整推导
- 基于心理学原理的科学分析

### 实操性强
- 提供具体的口头语、场景、道具建议
- 包含 30秒/60秒 内容模板
- 可直接用于短视频制作

### 平台导向
- 专门针对短视频平台优化
- 考虑算法推荐和用户喜好
- 强调传播力和记忆点

### 商业闭环
- 不仅是形象设计，更考虑变现路径
- 包含商业目的、情感目的、传播目的
- 确保IP能支撑实际商业运营

## 与其他步骤的关系

### 输入依赖
- **P1**: 行业目标分析 → 提供目标受众信息
- **P2**: 行业认知深度 → 提供内容定位参考
- **P3**: 情绪价值分析 → 提供情绪触点指引
- **IP传记**: 人物故事 → **核心输入源**

### 输出流向
- **P5**: IP文风设定 → 使用 P4 的口头语体系
- **P6**: 4X4内容规划 → 基于 P4 的IP定位
- **P7-P10**: 内容生产 → 遵循 P4 确立的人设框架

## 测试建议

### 功能测试
1. **访问 P4 页面**
   - URL: http://localhost:3000/dashboard/workflow/P4
   - 检查页面是否正常加载

2. **提示词加载**
   - 开始对话
   - 验证 AI 是否使用专业提示词回复
   - 检查回复是否包含内核分析、视觉锤设计等要素

3. **输出质量**
   - 上传 IP传记或提供人物信息
   - 验证 AI 是否生成完整的六大部分内容
   - 检查是否有具体的口头语、场景、道具建议

### 对比测试
- 对比修改前后的 AI 回复质量
- 验证是否更专业、更系统、更具操作性

## 后续工作

### P5-P10 提示词集成
按照相同方式，可以继续添加其他步骤的提示词：

1. **P5**: IP文风设定
   - 文件: `lib/prompts/persona/p5-style.ts`
   - 来源: `提示词/` 目录中对应的 Markdown 文件

2. **P6**: 4X4内容规划
   - 文件: `lib/prompts/persona/p6-planning.ts`
   - 来源: `提示词/商业IP4X4内容运营总监v1.4.md`

3. **P7-P10**: 内容生产步骤
   - 文件: `lib/prompts/production/p7-attraction.ts` 等
   - 需要确认是否有对应的 Markdown 文件

### 优化建议
1. **统一管理**: 考虑创建 `lib/prompts/index.ts` 作为统一导出入口
2. **类型定义**: 添加 TypeScript 类型定义，增强类型安全
3. **版本管理**: 在提示词文件中添加版本号和更新日志
4. **测试覆盖**: 为每个提示词添加自动化测试

## 相关文档

- **画布功能**: [CANVAS_CONTENT_SELECTION_FEATURE.md](CANVAS_CONTENT_SELECTION_FEATURE.md)
- **API 错误处理**: [API_ERROR_HANDLING_UPDATE.md](API_ERROR_HANDLING_UPDATE.md)
- **品牌更新**: [BRAND_UPDATE_SUMMARY.md](BRAND_UPDATE_SUMMARY.md)
- **IP传记更新**: [IP_BIOGRAPHY_UPDATES.md](IP_BIOGRAPHY_UPDATES.md)

## 更新日志

**2025-12-14**
- ✅ 创建 `lib/prompts/persona/` 目录
- ✅ 创建 `p4-concept.ts` 文件
- ✅ 在 `step-prompts.ts` 中导入并配置 P4
- ✅ 删除提示词文件中的版权声明
- ✅ 创建完整文档说明

## 完成状态

✅ **P4 提示词已成功集成**

- [x] 创建独立提示词文件
- [x] 导入到主配置
- [x] 清理版权声明
- [x] 创建文档说明
- [x] 模块化文件结构

**用户体验提升**:
- P4 现在使用专业、完整的提示词
- AI 提供系统化的IP概念分析
- 输出包含可执行的操作指南
- 支持画布编辑和保存功能
